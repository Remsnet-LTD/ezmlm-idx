# $Id$

###############
# ezmlm-split #
###############

if [ "$SECT" -le "3" ]; then

  prompt "ezmlm-split (2/2):    "

# we know that ezmlm-manage works. A bounce would go to MODDIR, so a
# message in SINKDIR means that the request was forwarded to ezmlm-manage,
# which replied with a confirmation request.
  ${GREP} 'X-num: spl1' $SINKDIR/new/* > /dev/null 2>&1 || \
	fatal	"failed to receive sub conf req." \
		"this could be a failure of ezmlm-split, but usually," \
		"it happens because ezmlm binaries when run by qmail" \
		"don't have access to shared libraries required for" \
		"RDBMS access. This happens on systems where RDBMS" \
		"shared libs are installed in the /usr/local hierarchy." \
		"fix: see ld.so man page on how to modify /etc/ld.so.conf" \
		"or compile statically by adding -static to conf-sqlld."

  ${ECHO} "OK"

fi
