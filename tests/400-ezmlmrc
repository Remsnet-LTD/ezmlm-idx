# $Id$

${ECHO} Verifying ezmlmrc contents and command dispatch...

remake() {
    run ezmlm-make -+ $1 "$DIR" \
	|| fatal "ezmlm-make failed"
}

remake_creates() {
    opts=$1
    shift
    remake -$opts
    for file in "$@"; do
      if [ ! -e "$DIR"/$file ]; then
	  fatal "file $file was missing after ezmlm-make -$opts"
      fi
    done
    opts=`echo $opts | tr a-zA-Z A-Za-z`
    remake -$opts
    for file in "$@"; do
      if [ -e "$DIR"/$file ]; then
	  fatal "file $file was not deleted after ezmlm-make -$opts"
      fi
    done
}

remake_creates a archived indexed
remake_creates f prefix
remake_creates h noconfirmsub
remake_creates j noconfirmunsub
remake_creates l remotelist
remake_creates m moderator modpost
remake_creates n remoteedit
remake_creates p public
remake_creates r remote
remake_creates s modsub
remake_creates w nowarn
remake_creates x mimeremove
remake_creates y confirmer confirmpost

run ezmlm-make -+p "$DIR"
