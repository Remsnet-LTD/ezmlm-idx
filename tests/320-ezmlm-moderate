# $Id$

##################
# ezmlm-moderate #
##################

if [ "$SECT" -le "3" ]; then

  prompt "ezmlm-moderate (2/2): "

  MOD1=`${GREP} -l "mod1" $SINKDIR/new/* | head -n 1` || \
	fatal "failed to send rejection notice for message mod1"

# ${SND}@$HOST means it was rejected, not send through the list
  ${GREP} "To: ${SND}@$HOST" "$MOD1" > /dev/null 2>&1 || \
	fatal "failed to reject message mod1"

  MOD3=`${GREP} -l "mod3" $SINKDIR/new/* | head -n 1`
  if [ -z "$MOD3" ]; then
    fatal "failed to post message mod3"
  fi

# ${LOC}@$HOST means it was not rejected, but sent through the list
  ${GREP} "To: ${LOC}@$HOST" "$MOD3" > /dev/null 2>&1 || \
	fatal "failed to reject message mod3"

  ${ECHO} "OK"

fi
