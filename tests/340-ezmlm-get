# $Id$

#############
# ezmlm-get #
#############

if [ "$SECT" -le "3" ]; then

  prompt "ezmlm-get (2/2):      "

# index1/get1/thread1 should bounce and will not be looked for
# index2 ... should be in DIG@HOST's inbox
# get3 - r format to DIG@HST
# get4 - n
# get5 - v
# get6 - x

# well - just a consistency check
  ${GREP} "index1" ${DIGDIR}/new/* >/dev/null 2>&1 && \
	fatal "index1 found in wrong mailbox"

# now check that they've been delivered. We don't check the formats,
# as this would be quite involved.
  ${GREP} "index2" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "index2 failed to return"
  ${GREP} "get2" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "get2 failed to return"
  ${GREP} "get3" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "get3 format 'r' failed to return"
  ${GREP} "get4" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "get3 format 'n' failed to return"
  ${GREP} "get5" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "get3 format 'v' failed to return"
  ${GREP} "get6" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "get3 format 'x' failed to return"

  ${GREP} "dig1" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig1 from manager wasn't delivered"
  ${GREP} "dig2" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig2 from editor wasn't delivered"
  ${GREP} "dig3" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig3 from command line wasn't delivered"
  ${GREP} "dig4" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig4 format 'r' wasn't delivered"
  ${GREP} "dig5" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig5 format 'n' wasn't delivered"
  ${GREP} "dig6" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig6 format 'x' wasn't delivered"
  ${GREP} "dig6" ${DIGDIR}/new/* >/dev/null 2>&1 || \
	fatal "dig6 format 'v' wasn't delivered"

  ${ECHO} "OK"

fi
